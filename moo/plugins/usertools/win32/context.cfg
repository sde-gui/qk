# -%- strip: false; indent-width: 2 -%-
[tool]
id = SwitchHeaderAndImplementation
name = Switch _Header and Implementation
langs = c, cpp, objc, chdr, gap
type = lua
options = need-file
  local tblx = require('pl.tablex'); local path = require('pl.path')
  
  extensions = {
    { {".h", ".hh", ".hpp", ".hxx", ".H"}, {".c", ".cc", ".cpp", ".cxx", ".C", ".m"} },
    { {".gd"}, {".gi"} },
  }
  
  new = nil
  base, ext = pl.path.splitext(doc.filename())
  
  for _, p in ipairs(extensions) do
    if tblx.find(p[1], ext) then
      new = p[2];
      break
    elseif tblx.find(p[2], ext) then
      new = p[1];
      break
    end
  end
  
  if not new then
    return
  end
  
  for _, e in ipairs(new) do
    file = base .. e
    if pl.path.exists(file) then
      editor.open_file(file)
      return
    end
  end
  
