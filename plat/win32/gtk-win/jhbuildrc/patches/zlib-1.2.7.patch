diff -r 4fc3be765909 Makefile
--- a/Makefile	Sun Jul 29 00:24:34 2012 -0700
+++ /dev/null	Thu Jan 01 00:00:00 1970 +0000
@@ -1,5 +0,0 @@
-all:
-	-@echo "Please use ./configure first.  Thank you."
-
-distclean:
-	make -f Makefile.in distclean
diff -r 4fc3be765909 Makefile.in
--- a/Makefile.in	Sun Jul 29 00:24:34 2012 -0700
+++ b/Makefile.in	Sun Jul 29 00:28:35 2012 -0700
@@ -70,7 +70,7 @@
 
 PIC_OBJS = $(PIC_OBJC) $(PIC_OBJA)
 
-all: static shared
+all: dll
 
 static: example$(EXE) minigzip$(EXE)
 
@@ -136,7 +136,7 @@
 
 match.lo: match.S
 	$(CPP) match.S > _match.s
-	$(CC) -c -fPIC _match.s
+	$(CC) -c _match.s
 	mv _match.o match.lo
 	rm -f _match.s
 
@@ -210,12 +210,12 @@
 # The ranlib in install is needed on NeXTSTEP which checks file times
 # ldconfig is for Linux
 
-install: install-libs
+install: install-dll
 	-@if [ ! -d $(DESTDIR)$(includedir)   ]; then mkdir -p $(DESTDIR)$(includedir); fi
 	cp zlib.h zconf.h $(DESTDIR)$(includedir)
 	chmod 644 $(DESTDIR)$(includedir)/zlib.h $(DESTDIR)$(includedir)/zconf.h
 
-uninstall:
+uninstall: uninstall-dll
 	cd $(DESTDIR)$(includedir); rm -f zlib.h zconf.h
 	cd $(DESTDIR)$(libdir); rm -f libz.a; \
 	if test -n "$(SHAREDLIBV)" -a -f $(SHAREDLIBV); then \
@@ -265,6 +265,23 @@
 depend:
 	makedepend -- $(CFLAGS) -- *.[ch]
 
+# begin muntyan additions
+dlldir = $(exec_prefix)/bin
+DLL = zlib1-m314.dll
+DLL_A = libz.dll.a
+$(DLL): $(OBJS)
+	$(CC) -shared -o $(DLL) -Wl,--out-implib=$(DLL_A) $(OBJS)
+dll: $(DLL)
+install-dll: dll
+	-@if [ ! -d $(DESTDIR)$(dlldir) ]; then mkdir -p $(DESTDIR)$(dlldir); fi
+	-@if [ ! -d $(DESTDIR)$(libdir) ]; then mkdir -p $(DESTDIR)$(libdir); fi
+	cp $(DLL) $(DESTDIR)$(dlldir)
+	cp $(DLL_A) $(DESTDIR)$(libdir)
+	rm -f $(DESTDIR)$(libdir)/$(STATICLIB)
+uninstall-dll:
+	rm -f $(DESTDIR)$(dlldir)/$(DLL) $(DESTDIR)$(libdir)/$(DLL_A)
+# end muntyan additions
+
 # DO NOT DELETE THIS LINE -- make depend depends on it.
 
 adler32.o zutil.o: zutil.h zlib.h zconf.h
diff -r 4fc3be765909 configure
--- a/configure	Sun Jul 29 00:24:34 2012 -0700
+++ b/configure	Sun Jul 29 00:28:35 2012 -0700
@@ -57,7 +57,7 @@
 
 # set defaults before processing command line options
 LDCONFIG=${LDCONFIG-"ldconfig"}
-LDSHAREDLIBC="${LDSHAREDLIBC--lc}"
+LDSHAREDLIBC=
 ARCHS=
 prefix=${prefix-/usr/local}
 exec_prefix=${exec_prefix-'${prefix}'}
@@ -184,7 +184,7 @@
   echo ... using gcc >> configure.log
   CC="$cc"
   CFLAGS="${CFLAGS--O3} ${ARCHS}"
-  SFLAGS="${CFLAGS--O3} -fPIC"
+  SFLAGS="${CFLAGS--O3}"
   LDFLAGS="${LDFLAGS} ${ARCHS}"
   if test $build64 -eq 1; then
     CFLAGS="${CFLAGS} -m64"
